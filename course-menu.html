<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../d2l-polymer-behaviors/d2l-id.html">
<link rel="import" href="../d2l-polymer-behaviors/d2l-pubsub.html">
<link rel="import" href="find-page-object-behavior.html">
<link rel="import" href="graft-behavior.html">

<dom-module id="d2l-navigation-course-menu">
	<template>
		<style>
			:host {
				display: block;
				line-height: 1.5rem;
			}
		</style>
		<div class="d2l-navigation-course-menu-container d2l-placeholder-inner"></div>
	</template>
</dom-module>
<script>
	Polymer({
		is: 'd2l-navigation-course-menu',

		_placeholderId: null,

		listeners: {
			'partial-render': '_onPartialRender',
			'course-pinned': '_onCoursePinned'
		},

		behaviors: [
			window.D2L.PolymerBehaviors.Navigation.FindPageObjectBehavior,
			window.D2L.PolymerBehaviors.Navigation.GraftBehavior
		],

		properties: {
			loaded: Boolean,
			isDirty: Boolean
		},

		load: function(isDirty) {

			if (!isDirty && this.loaded) {
				return;
			}

			if(!this._placeholderId) {
				this._placeholderId = D2L.Id.getUniqueId();

				this.$$('.d2l-navigation-course-menu-container')
					.setAttribute('id', this._placeholderId);
			}

			this.graft(this._placeholderId, isDirty);

		},

		_onPartialRender: function() {
			this.loaded = true;
			this.fire('d2l-navigation-course-menu-loaded');
		}

	});
</script>
